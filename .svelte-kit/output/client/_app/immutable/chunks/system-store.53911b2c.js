import{A as l,i as n,r as E,a as y}from"./Helpers.c6feb0fc.js";import{w as A}from"./index.c203a7c8.js";function D(){const{subscribe:r,set:_}=A(null);let o=l.createActor(n,"bkyz2-fmaaa-aaaaa-qaaaq-cai");async function S(){let a="system_state",s=(await o.getDataHashes()).find(e=>e.category===a)??null;const i=localStorage.getItem(a);if(s?.hash!=i){let e=await o.getSystemState();localStorage.setItem("system_state_data",JSON.stringify(e,E)),localStorage.setItem(a,s?.hash??""),_(e)}else{const e=localStorage.getItem("system_state_data");let c=null;try{c=JSON.parse(e||"{}")}catch{c=null}_(c)}}async function N(){let a;return r(t=>{a=t})(),a}async function I(a){try{const s=await(await l.createIdentityActor(y,"bkyz2-fmaaa-aaaaa-qaaaq-cai")).updateSystemState(a);return S(),s}catch(t){throw console.error("Error updating system state:",t),t}}return{subscribe:r,sync:S,getSystemState:N,updateSystemState:I}}const R=D();export{R as s};
